{% extends "base.html" %}

{% block content %}
  <div class="card mt-4">
    <div class="card-body">
      <small class="text-muted">By {{ post['author'] }}</small>
      <h2 class="card-title">{{ post['title'] }}</h2>
      <p class="card-text">{{ post['content'] }}</p>
      <p class="text-muted">Posted on {{ post['created'] }}</p>
      <a href="{{ url_for('home') }}" class="btn btn-secondary">Back</a>
    </div>
  </div>

  <!-- Comments Section -->
  <div class="mt-5">
    <h4>Comments</h4>

    {% if session.get('user_id') %}
      <form method="POST">
        <div class="mb-3">
          <textarea name="content" class="form-control" placeholder="Your comment"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
      </form>
    {% else %}
      <p><a href="{{ url_for('login') }}">Log in</a> to leave a comment.</p>
    {% endif %}

    <ul class="list-group mt-4">
      {% for comment in comments %}
        <li class="list-group-item">
          <strong>{{ comment['author'] }}</strong> said:
          <p>{{ comment['content'] }}</p>
          <small class="text-muted">{{ comment['created'] }}</small>
        </li>
      {% else %}
        <li class="list-group-item">No comments yet. Be the first!</li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}
